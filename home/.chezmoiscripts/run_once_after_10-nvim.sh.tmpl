#!/bin/sh
set -eux
eg=~/.local/bin/eget


{{ if eq .chezmoi.osRelease.id "debian" }}
sudo apt install -y --no-install-suggests --no-install-recommends \
{{ if .useNvim }} build-essential {{ else }} vim-tiny {{ end }}
sudo apt purge -y \
{{ if .useNvim }} vim-tiny {{ else }} build-essential {{ end }}
sudo apt clean && sudo apt autoremove -y
{{ end }}


{{ if .useNvim -}}
{{ if eq .chezmoi.osRelease.id "debian" }}
${eg} neovim/neovim -a appimage --to=~/.appimages/neovim.appimage
ln -fs ~/.appimages/neovim.appimage ~/.local/bin/nvim
{{ end }}


{{ else }}
# remove all nvim-related symlinks and appimages
rm -f ~/.local/bin/nvim ~/.appimages/neovim.appimage
{{ end }}
