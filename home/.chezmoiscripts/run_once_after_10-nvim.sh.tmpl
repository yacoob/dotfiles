#!/bin/sh
set -eux
eg=~/.local/bin/eget


{{ if eq .chezmoi.osRelease.id "debian" }}
  sudo apt install -y --no-install-suggests --no-install-recommends \
  {{ if .devEnv }} build-essential {{ else }} vim-tiny {{ end }}
  sudo apt purge -y \
  {{ if .devEnv }} vim-tiny {{ else }} build-essential {{ end }}
  sudo apt clean && sudo apt autoremove -y
  {{ if .devEnv -}}
    ${eg} neovim/neovim -a appimage --to=~/.appimages/neovim.appimage
    ln -fs ~/.appimages/neovim.appimage ~/.local/bin/nvim
  {{ else }}
    # remove all nvim-related symlinks and appimages
    rm -f ~/.local/bin/nvim ~/.appimages/neovim.appimage
  {{ end }}
{{ end }}
