#!/bin/sh
set -eux


{{ if eq .chezmoi.osRelease.id "debian" }}
sudo apt update
sudo apt install -y --no-install-suggests --no-install-recommends \
  libgcc-s1 \
  curl file fuse git less openssh-client pv sudo vim-tiny wget zsh
sudo apt clean && sudo apt autoremove -y

bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"


{{ else if eq .chezmoi.osRelease.id "aurora" }}
# install flatpaks
for f in \
  com.bitwarden.desktop \
  com.calibre_ebook.calibre \
  com.discordapp.Discord \
  com.plexamp.Plexamp \
  com.slack.Slack \
  com.valvesoftware.Steam \
  io.github.martchus.syncthingtray \
  it.mijorus.gearlever \
  md.obsidian.Obsidian \
  org.speedcrunch.SpeedCrunch \
  org.telegram.desktop \
  org.wezfurlong.wezterm \
  tv.plex.PlexDesktop
do
  flatpak install --system --assumeyes ${f}
done

# install homebrews
brew install \
  bat \
  bottom \
  difftastic \
  direnv \
  fd \
  gcc \
  gdu \
  lazygit \
  ripgrep \
  strace \
  tealdeer \
  trash-cli \
  ugrep \
  viu \
  watchexec \
  yq
brew cleanup --prune=all --scrub
rm -rf "$(brew --cache)"

{{ end }}
